<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-a11y-keys/iron-a11y-keys.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="bnb-actions.html">
<link rel="import" href="bnb-auth-form.html">
<link rel="import" href="bnb-oauth.html">

<dom-module id="bnb-signin">
  <template>
    <style>
      :host {
        @apply --layout-horizontal;
        @apply --layout-center-justified;
      }
    </style>

    <iron-a11y-keys keys="enter" target="[[target]]" on-keys-pressed="signinSubmitTapped">
    </iron-a11y-keys>

    <bnb-auth-form id="signin-form" name="signin" title="Sign in" buttons="[[signinButtons]]">

      <paper-input label="E-mail" type="email" value="{{email}}" autofocus="true">
      </paper-input>

      <paper-input label="Password" autocomplete="off" type="password" value="{{password}}">
      </paper-input>

      <div class="actions">
        <paper-button on-tap="signinSubmitTapped">Log in</paper-button>
      </div>

      <bnb-oauth></bnb-oauth>

    </bnb-auth-form>
  </template>


  <script>
    class BnbSignIn extends BnbActions(Polymer.Element) {
      static get is() { return 'bnb-signin'; }

      static get properties() {
        return {
          credentials: {
            type: Object,
            statePath: 'credentials',
            observer: '_credentialsChanged'
          },

          email: String,
          password: String,

          target: Object,
          signinButtons: Array
        }
      }

      ready() {
        super.ready();
        this.target = this.$['signin-form'];
        this.signinButtons = [{text:'Sign up', path:'/signup'}, {text:'Forgot your password', path:'/forgot-password'}];
      }

      signinSubmitTapped() {
        this.signin(this.email, this.password);
      }

      _credentialsChanged() {
        this.email = '';
        this.password = '';
      }
    }

    window.customElements.define(BnbSignIn.is, BnbSignIn);

  </script>

</dom-module>
