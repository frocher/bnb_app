<link rel="import" href="../../bower_components/iron-image/iron-image.html">
<link rel="import" href="../../bower_components/paper-ripple/paper-ripple.html">

<dom-module id="bnb-page-card">
  <style>
  :host {
    display: inline-block;
    position: relative;
    box-sizing: border-box;
    border-radius: 2px;
    width: 320px;
    margin: 5px;
    cursor: pointer;
  }

  .header {
    position: relative;
    @apply(--paper-card-header);
  }

  .header iron-image {
    width: 100%;
    padding-bottom: 75%;
    pointer-events: none;
    background-color: lightgray;
  }

  :host ::content h2 {
    margin-top: 0;
    margin-bottom: 2px;
  }

  :host ::content a {
    color: #9e9e9e;
    text-decoration: none;
  }

  .card-content a:hover {
    text-decoration: underline;
  }

  .card-content {
    padding: 16px;
    position:relative;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  .card-content .card-actions {
    border-top: 1px solid #e8e8e8;
    padding: 5px 16px;
    position:relative;
  }

  .header {
    height: 240px;
  }

  #shadow {
    @apply(--shadow-2dp);
    background-color: var(--paper-card-background-color);
  }

  #shadow:hover {
    @apply(--shadow-elevation-8dp);
  }

  </style>

  <template>
    <paper-material id="shadow" animated$="[[animatedShadow]]" elevation=[[elevation]] on-tap="cardTapped">

      <div class="header">
        <iron-image sizing="cover" preload fade src="[[_computeScreenshotUrl(page)]]"></iron-image>
      </div>

      <div class="card-content">
        <h2>[[page.name]]</h2>
        <a href="#" on-tap="urlTapped" title="Open url in a new tab">[[page.url]]</a>
      </div>
      <paper-ripple></paper-ripple>

    </paper-material>

  </template>

</dom-module>

<script>

  Polymer({
    is: 'bnb-page-card',

    properties: {
      /**
       * The page of the card.
       */
      page: {
        type: Object,
        value: null
      },

      /**
       * The z-depth of the card, from 0-5.
       */
      elevation: {
        type: Number,
        value: 1
      },

      /**
       * Set this to true to animate the card shadow when setting a new
       * `z` value.
       */
      animatedShadow: {
        type: Boolean,
        value: true
      }
    },

    cardTapped: function(e) {
      this.fire('show-page', {page: this.page});
    },

    urlTapped: function(e) {
      window.open(this.page.url, '_blank');
      e.stopPropagation();
    },

    _computeScreenshotUrl: function(item) {
      return BnbService.BASE_URL + 'pages/' + item.id + '/screenshot?style=thumb';
    }

  });
</script>
